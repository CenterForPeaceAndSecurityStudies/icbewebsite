---
title: 'CrisisEvents.org'
output:
  html_document:
    toc: no
    self_contained: no
    lib_dir: 'lib'
---

<style>
    body .main-container {
        max-width: 1500px;
    }
</style>


```{r setup, include=FALSE, echo=F, results='hide',  include=T, message=F, cache=F, warning=F}

source('/mnt/8tb_a/rwd_github_private/icbe/docs/maps.r')


#On how to reset the repo to save space
#https://github.com/18F/C2/issues/439

knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)

icb_crises <-readRDS(paste0(here::here(), "/docs/icb1v14.Rds") )

icb_crises$decade <- floor(icb_crises$yrtrig/10)*10
icb_crises$decade_5 <- icb_crises$decade  + (icb_crises$yrtrig %% 10 > 5)*5

fromscratch=F
library(glue)
n <- 476
chunk <- function(x,n) split(x, factor(sort(rank(x)%%n)))
chunks <- chunk(1:n,30)

df <- sapply(chunks, range) %>% t() %>% as.data.frame() %>%
  mutate(filenames_html = glue("ICBe_Website_Cases_{V1}to{V2}.html")) %>%
  mutate(filenames_rmd = glue("/mnt/8tb_a/rwd_github_private/icbe/docs/ICBe_Website_Cases_{V1}to{V2}.rmd")) %>%
  mutate(link = glue("[{V1}-{V2}](ICBe_Website_Cases_{V1}to{V2}.html);"))


```

Back to [Main Page](/index.html). 

```{r, echo=F, results='asis',  include=T, message=F, cache=F, warning=F}

cat('\n\n# {.tabset .tabset-fade .tabset-pills}\n\n') #Start tabs for decades

for(d in na.omit(unique(icb_crises$decade))){ #for debuging can limit it to just 2 decades #[1:2]
  
  #Start tab for cases
  if( d==1960){ cat('\n\n## ', d , ' {.active .tabset .tabset-fade .tabset-pills} \n\n') } else {
    cat('\n\n## ', d , ' {.tabset .tabset-fade .tabset-pills} \n\n' )  
  }

  for(year in icb_crises %>% filter(decade %in% d) %>% pull(yrtrig) %>% unique() ) {
    if( year==1962){ cat('\n\n### ', year , ' {.active .tabset .tabset-fade .tabset-pills} \n\n') } else {
      cat('\n\n### ', year , ' {.tabset .tabset-fade .tabset-pills} \n\n' )  
    }  
    
    for(crisis in icb_crises %>% filter(yrtrig %in% year) %>% pull(crisno) ) { 
      map(crisis, fromscratch=F)
    }
  #cat('\n\n## {-}\n\n') #Close tab for cases
  }
}
cat('\n\n# {-}\n\n') #Close tab for decades

```
